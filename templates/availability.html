{% extends "base.html" %} {% block content %}

<div class="container" style="margin-top: 60px">
  <h1 style="text-align: center">Plan Your Stay</h1>
  <p style="text-align: center; color: #666; margin-bottom: 30px">
    Select your dates to see real-time pricing.
  </p>

  <form action="/availability" method="POST" class="booking-form">
    <div class="form-group">
      <label>Check-in Date:</label>
      <input
        type="date"
        name="checkin"
        required
        value="{{ checkin if checkin else '' }}"
      />
    </div>

    <div class="form-group">
      <label>Check-out Date:</label>
      <input
        type="date"
        name="checkout"
        required
        value="{{ checkout if checkout else '' }}"
      />
    </div>

    <div class="form-group">
      <label>Guests:</label>
      <select name="guests">
        <option value="2">2 Guests</option>
        <option value="4">4 Guests</option>
      </select>
    </div>

    <button
      type="submit"
      class="btn-primary"
      style="height: 46px; margin-bottom: 2px"
    >
      Check Prices
    </button>
  </form>

  <hr style="border: 0; border-top: 1px solid #eee; margin: 40px 0" />

  {% if results %}
  <h2>Available Rooms for {{ nights }} Night(s)</h2>
  <div class="room-grid">
    {% for item in results %}
    <div class="room-card">
      <img
        src="{{ url_for('static', filename='images/' + (item.image if item.image else 'default.jpg')) }}"
        alt="{{ item.room_name }}"
        style="width: 100%; height: 200px; object-fit: cover"
      />

      <div class="room-details">
        <h3>{{ item.room_name }}</h3>
        <p>Capacity: {{ item.capacity }} Pax</p>

        <div class="price-breakdown">
          <p>Total Price: <strong>₹{{ item.total_price }}</strong></p>

          {% if item.weekend_nights > 0 %}
          <small style="color: #e67e22">
            Includes {{ item.weekend_nights }} Weekend Night{% if
            item.weekend_nights > 1 %}s{% endif %}
          </small>
          {% else %}
          <small style="color: #27ae60"> Weekday Saver Rates applied! </small>
          {% endif %}
        </div>

        <a
          href="https://wa.me/91XXXXXXXXXX?text=Hi, I am interested in {{ item.room_name }}. Dates: {{ checkin }} to {{ checkout }} ({{ nights }} nights). Total Quote: ₹{{ item.total_price }}."
          target="_blank"
          class="btn-primary"
          style="width: 100%; box-sizing: border-box"
        >
          Confirm on WhatsApp
        </a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}
</div>

{% endblock %}
